<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>타이핑 게임</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            overflow: hidden;
        }

        .game-container {
            width: 100%;
            max-width: 800px;
            height: 100vh;
            margin: 0 auto;
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            border-left: 2px solid #0f3460;
            border-right: 2px solid #0f3460;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.5);
            color: #fff;
            font-size: 18px;
        }

        .score {
            color: #00d9ff;
            font-weight: bold;
        }

        .lives {
            color: #ff6b6b;
            font-weight: bold;
        }

        .level {
            color: #4ade80;
            font-weight: bold;
        }

        .game-area {
            width: 100%;
            height: calc(100vh - 130px);
            position: relative;
            overflow: hidden;
        }

        .word {
            position: absolute;
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: transform 0.1s;
            white-space: nowrap;
        }

        .word.matched {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            transform: scale(1.1);
        }

        .word.partial {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        }

        .input-area {
            position: absolute;
            bottom: 0;
            width: 100%;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            gap: 10px;
        }

        .input-area input {
            flex: 1;
            padding: 15px 20px;
            font-size: 20px;
            border: none;
            border-radius: 30px;
            background: #fff;
            outline: none;
            color: #333;
        }

        .input-area input:focus {
            box-shadow: 0 0 20px rgba(0, 217, 255, 0.5);
        }

        .danger-zone {
            position: absolute;
            bottom: 80px;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #ff6b6b, transparent);
            box-shadow: 0 0 20px #ff6b6b;
        }

        .start-screen, .game-over-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            z-index: 100;
        }

        .start-screen h1, .game-over-screen h1 {
            font-size: 48px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .start-screen p, .game-over-screen p {
            font-size: 18px;
            margin-bottom: 30px;
            color: #aaa;
            text-align: center;
            line-height: 1.6;
        }

        .final-score {
            font-size: 24px;
            color: #00d9ff;
            margin-bottom: 20px;
        }

        .btn {
            padding: 15px 40px;
            font-size: 20px;
            border: none;
            border-radius: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
        }

        .hidden {
            display: none !important;
        }

        .combo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 36px;
            font-weight: bold;
            color: #fbbf24;
            text-shadow: 0 0 20px #fbbf24;
            animation: comboFade 1s forwards;
            pointer-events: none;
        }

        @keyframes comboFade {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -100%) scale(1.5); }
        }

        .effect {
            position: absolute;
            pointer-events: none;
            animation: explode 0.5s forwards;
        }

        @keyframes explode {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(2); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <div class="score">점수: <span id="score">0</span></div>
            <div class="level">레벨: <span id="level">1</span></div>
            <div class="lives">생명: <span id="lives">♥♥♥</span></div>
        </div>

        <div class="game-area" id="gameArea">
            <div class="danger-zone"></div>
        </div>

        <div class="input-area">
            <input type="text" id="typingInput" placeholder="여기에 단어를 입력하세요..." autocomplete="off">
        </div>

        <div class="start-screen" id="startScreen">
            <h1>타이핑 게임</h1>
            <p>떨어지는 단어를 타이핑해서 없애세요!<br>단어가 바닥에 닿으면 생명이 줄어듭니다.</p>
            <button class="btn" id="startBtn">게임 시작</button>
        </div>

        <div class="game-over-screen hidden" id="gameOverScreen">
            <h1>게임 오버</h1>
            <div class="final-score">최종 점수: <span id="finalScore">0</span></div>
            <p>최고 기록: <span id="highScore">0</span></p>
            <button class="btn" id="restartBtn">다시 시작</button>
        </div>
    </div>

    <script>
        const words = [
            // 쉬운 단어 (레벨 1-2)
            '사과', '바나나', '포도', '딸기', '수박', '참외', '복숭아', '배', '감', '귤',
            '하늘', '바다', '산', '강', '숲', '꽃', '나무', '구름', '별', '달',
            '고양이', '강아지', '토끼', '새', '물고기', '호랑이', '사자', '곰', '여우', '늑대',
            // 중간 단어 (레벨 3-4)
            '컴퓨터', '키보드', '마우스', '모니터', '스피커', '프린터', '노트북', '태블릿',
            '프로그램', '인터넷', '소프트웨어', '하드웨어', '네트워크', '데이터베이스',
            '자동차', '비행기', '기차', '자전거', '오토바이', '헬리콥터', '잠수함',
            // 어려운 단어 (레벨 5+)
            '프로그래밍', '알고리즘', '자료구조', '운영체제', '컴파일러', '인공지능',
            '블록체인', '클라우드', '빅데이터', '사이버보안', '머신러닝', '딥러닝',
            '아이스크림', '햄버거', '스파게티', '샌드위치', '치즈케이크', '초콜릿',
            // 영어 단어
            'apple', 'banana', 'computer', 'keyboard', 'program', 'internet',
            'javascript', 'python', 'coding', 'developer', 'software', 'hardware',
            'game', 'player', 'score', 'level', 'typing', 'speed', 'fast', 'slow'
        ];

        class TypingGame {
            constructor() {
                this.gameArea = document.getElementById('gameArea');
                this.typingInput = document.getElementById('typingInput');
                this.scoreDisplay = document.getElementById('score');
                this.levelDisplay = document.getElementById('level');
                this.livesDisplay = document.getElementById('lives');
                this.startScreen = document.getElementById('startScreen');
                this.gameOverScreen = document.getElementById('gameOverScreen');
                this.finalScoreDisplay = document.getElementById('finalScore');
                this.highScoreDisplay = document.getElementById('highScore');
                this.startBtn = document.getElementById('startBtn');
                this.restartBtn = document.getElementById('restartBtn');

                this.score = 0;
                this.lives = 3;
                this.level = 1;
                this.combo = 0;
                this.activeWords = [];
                this.gameLoop = null;
                this.spawnLoop = null;
                this.isPlaying = false;
                this.highScore = localStorage.getItem('typingGameHighScore') || 0;

                this.bindEvents();
            }

            bindEvents() {
                this.startBtn.addEventListener('click', () => this.startGame());
                this.restartBtn.addEventListener('click', () => this.startGame());
                this.typingInput.addEventListener('input', (e) => this.checkInput(e.target.value));
            }

            startGame() {
                this.score = 0;
                this.lives = 3;
                this.level = 1;
                this.combo = 0;
                this.activeWords = [];
                this.isPlaying = true;

                this.updateDisplay();
                this.clearWords();

                this.startScreen.classList.add('hidden');
                this.gameOverScreen.classList.add('hidden');
                this.typingInput.value = '';
                this.typingInput.focus();

                this.gameLoop = setInterval(() => this.update(), 50);
                this.spawnLoop = setInterval(() => this.spawnWord(), this.getSpawnInterval());

                setTimeout(() => this.spawnWord(), 500);
            }

            getSpawnInterval() {
                return Math.max(1500 - (this.level * 150), 600);
            }

            getFallSpeed() {
                return 0.5 + (this.level * 0.15);
            }

            getWordForLevel() {
                let pool;
                if (this.level <= 2) {
                    pool = words.slice(0, 30);
                } else if (this.level <= 4) {
                    pool = words.slice(0, 55);
                } else {
                    pool = words;
                }
                return pool[Math.floor(Math.random() * pool.length)];
            }

            spawnWord() {
                if (!this.isPlaying) return;

                const word = this.getWordForLevel();
                const wordElement = document.createElement('div');
                wordElement.className = 'word';
                wordElement.textContent = word;
                wordElement.dataset.word = word;

                const maxX = this.gameArea.clientWidth - 150;
                const x = Math.random() * maxX + 20;

                wordElement.style.left = x + 'px';
                wordElement.style.top = '-50px';

                this.gameArea.appendChild(wordElement);
                this.activeWords.push({
                    element: wordElement,
                    word: word,
                    y: -50
                });
            }

            update() {
                if (!this.isPlaying) return;

                const dangerY = this.gameArea.clientHeight - 100;
                const fallSpeed = this.getFallSpeed();

                for (let i = this.activeWords.length - 1; i >= 0; i--) {
                    const wordObj = this.activeWords[i];
                    wordObj.y += fallSpeed;
                    wordObj.element.style.top = wordObj.y + 'px';

                    if (wordObj.y > dangerY) {
                        this.removeWord(i);
                        this.loseLife();
                    }
                }

                // 레벨업 체크
                const newLevel = Math.floor(this.score / 100) + 1;
                if (newLevel > this.level) {
                    this.level = newLevel;
                    this.levelDisplay.textContent = this.level;

                    clearInterval(this.spawnLoop);
                    this.spawnLoop = setInterval(() => this.spawnWord(), this.getSpawnInterval());

                    this.showCombo('레벨 업!');
                }
            }

            checkInput(input) {
                if (!this.isPlaying) return;

                const lowerInput = input.toLowerCase();

                for (let i = 0; i < this.activeWords.length; i++) {
                    const wordObj = this.activeWords[i];
                    const word = wordObj.word.toLowerCase();

                    if (word === lowerInput) {
                        // 정답!
                        this.combo++;
                        const comboBonus = Math.floor(this.combo / 3);
                        const points = 10 + (wordObj.word.length * 2) + (comboBonus * 5);
                        this.score += points;

                        wordObj.element.classList.add('matched');
                        this.createEffect(wordObj.element);

                        if (this.combo > 0 && this.combo % 3 === 0) {
                            this.showCombo(`${this.combo} 콤보!`);
                        }

                        setTimeout(() => {
                            this.removeWord(i);
                        }, 150);

                        this.typingInput.value = '';
                        this.updateDisplay();
                        return;
                    } else if (word.startsWith(lowerInput) && lowerInput.length > 0) {
                        wordObj.element.classList.add('partial');
                    } else {
                        wordObj.element.classList.remove('partial');
                    }
                }
            }

            createEffect(element) {
                const rect = element.getBoundingClientRect();
                const gameRect = this.gameArea.getBoundingClientRect();

                for (let i = 0; i < 8; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'effect';
                    particle.style.left = (rect.left - gameRect.left + rect.width / 2) + 'px';
                    particle.style.top = (rect.top - gameRect.top + rect.height / 2) + 'px';
                    particle.style.width = '10px';
                    particle.style.height = '10px';
                    particle.style.background = '#4ade80';
                    particle.style.borderRadius = '50%';
                    this.gameArea.appendChild(particle);

                    setTimeout(() => particle.remove(), 500);
                }
            }

            showCombo(text) {
                const comboEl = document.createElement('div');
                comboEl.className = 'combo';
                comboEl.textContent = text;
                this.gameArea.appendChild(comboEl);

                setTimeout(() => comboEl.remove(), 1000);
            }

            removeWord(index) {
                if (this.activeWords[index]) {
                    this.activeWords[index].element.remove();
                    this.activeWords.splice(index, 1);
                }
            }

            clearWords() {
                this.activeWords.forEach(w => w.element.remove());
                this.activeWords = [];
            }

            loseLife() {
                this.lives--;
                this.combo = 0;
                this.updateDisplay();

                if (this.lives <= 0) {
                    this.gameOver();
                }
            }

            updateDisplay() {
                this.scoreDisplay.textContent = this.score;
                this.levelDisplay.textContent = this.level;
                this.livesDisplay.textContent = '♥'.repeat(this.lives) + '♡'.repeat(3 - this.lives);
            }

            gameOver() {
                this.isPlaying = false;
                clearInterval(this.gameLoop);
                clearInterval(this.spawnLoop);

                if (this.score > this.highScore) {
                    this.highScore = this.score;
                    localStorage.setItem('typingGameHighScore', this.highScore);
                }

                this.finalScoreDisplay.textContent = this.score;
                this.highScoreDisplay.textContent = this.highScore;
                this.gameOverScreen.classList.remove('hidden');
            }
        }

        // 게임 시작
        const game = new TypingGame();
    </script>
</body>
</html>
